# UASB - Summer 2019 Research Report
### By Nina Blahut, Shania Fang, Emily Liu, Kanha Matai, Cara Smith
#### June 28, 2019

## Table of Contents
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->


  - [Abstract](#abstract)
  - [Introduction](#introduction)
  - [Literature Review and Previous Work](#literature-review-and-previous-work)
  - [Timeline of UASB](#timeline-of-uasb)
      - [Summer 2016](#summer-2016)
      - [2016](#fall-2016)
      - [Spring 2017](#spring-2017)
      - [Summer 2017](#summer-2017)
      - [Fall 2017](#fall-2017)
      - [Spring 2018](#spring-2018)
      - [Summer 2018](#summer-2018)
      - [Fall 2018](#fall-2018)
      - [Spring 2019](#spring-2019)
  - [Summer 2019 Goals](#spring-2019-goals)
  - [Methods](#methods)
  - [Design Manual](#design-manual)
      - [Tipping Bucket Influent System](#tipping-bucket-influent-system)
      - [Reactor Body](#reactor-body)
  - [2019 TechConnect](#2019-techconnect)
  - [Future Work](#future-work)
- [EPA Funding Assurance](#epa-funding-assurance)

## Abstract

## Introduction


## Literature Review and Previous Work
According to [US Geological Survey](https://water.usgs.gov/edu/wuww.html) (USGS), wastewater is any kind of water used by humans. This used water may include dissolved fecal and urine matter, harmful chemicals, pathogens, and many more pollutants. Because it is full of contaminants, it's not longer safe for use. Since water is a universal solvent, it becomes difficult to separate the water from these harmful compounds. These compounds come from a variety of sources such as household wastes from toilets, sinks, baths, and drains or from factories, farming, schools, and urban runoff. As a result, billions of gallons of wastewater are produced and yet many areas in the world still lack access to wastewater treatment plants, thus making wastewater a global issue. Leaving wastewater untreated and releasing it directly back into the environment can produce devastating effects on both the environment and human health.

Wastewater can also contain decaying organic matter and nutrients such as phosphorus and nitrogen which can cause eutrophication, a term for excess nutrients. Eutrophication then causes algae blooms, leading to oxygen-deprived conditions once the large amount of algae dies off and begins to decompose. This negatively impacts the ecosystem because the lack of oxygen makes it harder for aquatic life to survive. At high concentrations, these water pollutants and organic matter are killing marine birds, crustaceans, sea weeds, and many other organisms. Having too much nitrogen in water can also be dangerous for humans because it can cause methemoglobinemia (blue baby syndrome) by preventing normal uptake of oxygen in the blood.

Human health is also directly affected by a lack of wastewater treatment. Much of untreated wastewater eventually ends up in our rivers, streams, and sometimes ground water. It is often assumed that groundwater is pure and clean; however, it is possible for groundwater to be contaminated by wastewater seeping into the ground. ([Catherine Taylor & Joseph Yahner, 1996](https://engineering.purdue.edu/~frankenb/NU-prowd/disease.htm)). When wastewater reaches drinking water sources, it can pose significant health risks for the community. Pathogens in wastewater destroy crop production, infecting the food supply, and cause water-borne diseases. Some of the many bacteria, viruses, and parasites present in wastewater include: cholera, typhoid, giardiasis and  cryptosporidiosis. ([Catherine Taylor & Joseph Yahner, 1996](https://engineering.purdue.edu/~frankenb/NU-prowd/disease.htm)). Health risks associated with wastewater includes respiratory disease, cancer, diarrheal disease, a neurological disorder, and cardiovascular disease ([Mehtab Haseena, 2017](http://www.alliedacademies.org/articles/water-pollution-and-human-health-7925.html)).

Some of the biggest issues that wastewater treatment plants face today are energy consumption and environmental footprints. Wastewater facilities typically have treatment processes that include preliminary treatment, sedimentation, chlorination, and processing sludge which are all electrically and fuel powered ([AOS, 2018](https://aosts.com/how-much-energy-does-wastewater-treatment-plant-use/)). In 2018, there were about 14,748 wastewater treatment plants in the US and electricity accounts for 90-95% of the total energy consumed at these facilities while the rest is accounted by fuels such as oil or natural gas. ([University of Michigan, 2019](http://css.umich.edu/factsheets/us-wastewater-treatment-factsheet)). Wastewater Treatment plants end up using up about 3% of the nation’s total energy consumption ([MGOe, 2019](https://www.mge.com/saving-energy/business/bea/article_detail.htm?nid=%202431)). However, not all countries have access or can afford the same resources such as money, infrastructure, materials, and technology, which makes having universal wastewater treatment plants not feasible in many parts of the world, especially more rural and less developed areas.

Traditional UASB reactors are used as a preliminary wastewater treatment process to remove suspended solids organic matter in wastewater (Chong et. al, 2012). UASB reactors, instead of using fuel or electricity, rely mainly on gravity and biological processes to remove organic matter and convert it to biogas. UASB stands for Upflow Anaerobic Sludge Blanket and a UASB reactor is a single tank process where wastewater enters the reactor and flows upward through a suspended sludge blanket. This suspended sludge blanket is made up of cultures of anaerobic microorganisms that filters and cleans wastewater by removing organic contaminants and pathogens. UASB reactors are highly efficient in treating high COD loads, biogas formation, and provide good stabilization of solids ([M.K. Daud, 2018](https://www.hindawi.com/journals/jchem/2018/1596319/)).They are less energy intensive than other forms of preliminary wastewater treatment that use aerobic processes. UASB reactors also produce methane as a byproduct of anaerobic digestion which can be captured and used for energy production or heating. However, these UASB reactors still rely on electricity.

AguaClara, on the other hand, has designed a UASB reactor that solely relies on gravity. It’s main function is to improve the accessibility and affordability of wastewater treatment for smaller communities that don’t have access to electricity. In January 2017, this gravity-powered UASB reactor was designed for the EPA People, Prosperity and the Planet (P3) Student Design Competition proposal. The proposed UASB reactor design focused on improving reactor design, making the system cheaper and easier to fabricate so that it could be created globally. The team later applied for Phase II funding from the same organization to support the development and implementation of additional reactors for testing and received a grant of $75,000.

## Timeline of UASB
#### Summer 2016
The UASB team was formed in the Summer of 2016. At that point, the objective of the team was to design and implement a functional lab-scale UASB reactor to treat synthetic blackwater. Blackwater is wastewater from toilets; synthetic blackwater is a mixture of proteins, lipids and starches mixed together (usually with a few other chemicals as well; recipes for synthetic wastewater vary) In the summer of 2016, the UASB team constructed four small-scale UASB reactors and found that those small-scale reactors could successfully treat synthetic wastewater. The team also found that increased wastewater concentration and higher residence times resulted in higher biogas removal and increased Chemical Oxygen Demand (COD) removal.

#### Fall 2016
In the fall of 2016, the UASB team underwent several changes. First, the team altered the design of the small-scale UASB reactors by implementing shorter and narrower influent lines. The team also changed the synthetic wastewater recipe. More specifically, the team substituted glucose with insoluble carbon compounds. The team also researched retention time in the reactors with fluoride tracer tests, and found a HRT of 3.22 hours in one of the reactors (close to the target of 4 hours).

#### Spring 2017
During the spring of 2017, the team worked on assessing the efficiency of two modifications to the UASB reactor: plate settlers and the submerged gas collection lid. After conducting granule settling tests, the team was unable to conclude whether or not plate settlers significantly improve solid retention time. The team also conducted a Submerged Gas Capture Lid Test and concluded that a check valve would be useful to allow for continuous collection into a gas tank without loss of biogas.

#### Summer 2017
In the summer of 2017, the UASB team continued with similar research and testing to that of the Spring 2017 semester. This time, the team determined that large, bulky plate settlers were not required for a full scale reactor. Instead, a smaller settling apparatus, such as a sloped exit weir, can achieve similar sludge retention time(SRT).

#### Fall 2017
During the fall of 2017, the UASB team made several strides. Firstly, the team settled on the critical design assumptions for the fabrication of a UASB reactor at the Ithaca Area Wastewater Treatment Facility (IAWWTF). The critical design assumptions were as follows: a reactor diameter of 3 feet, a reactor height of 7 feet, a 4 hour hydraulic residence time, and a flow rate of .036 L/s. The  team also designed a biogas capture lid. In this system, as biogas is produced in the reactor, it displaces water out from under the lid. Gas is then stored there until it is manually removed.

The team also wrote Python calculations in Jupyter notebook (available on GitHub) to estimate biogas production based on COD input.

Next, the team decided to add plate settlers back to the effluent tube. Plate settlers are intended to prevent dislodged granules from escaping the reactor. The fall 2017 team also worked on designing a sludge weir for the UASB reactor.

#### Spring 2018
UASB continued efforts to improve the design of the pilot-scale UASB reactor in Spring 2018. A major area of focus was the influent flow system. After extensive research, the team chose top influent flow - where the wastewater flows down the inlet pipe until it reaches the bottom of tank -  in order to prevent clogs. Next, the team decided to incorporate pulse flow into the reactor to achieve the desired flow of .03 L/s. The team proposed two methods to produce pulse flow: a tipping bucket design and a siphon.

UASB also worked on biogas production. The team wrote code to estimate the COD concentration of influent and the temperature of the reactor, as well as the biogas production rate based on the flow rate through the reactor. The team decided on a gas bag system to store biogas as it is flexible, easy to connect to the reactor, affordable, and easily transported. The team also wrote code to determine the required volume and dimensions for the lid of the biogas system. The team also looked into a fats, oils and greases (FOG) removal system. The conclusion was that manual skimming of FOG could always be used as a backup option.

Next, the team developed the design for the pilot UASB reactor's sludge sampling and removal system. For the sludge weir, the team chose a tube with a 6 inch diameter jutting out of the reactor at the predicted height of the sludge blanket at a downwards angle with two valves.

Lastly, the team wrote code to calculate the optimal size of the pilot UASB reactor's tube settler, the number of plates required, and the overall height of the settling arm.

#### Summer 2018
The summer team continued work on the hydraulic design of the UASB system.  The major design project was creating the tipping bucket system to deliver wastewater in pulses. The system consists of a pivoting bucket which fills with wastewater before tipping and delivering the wastewater in a large pulse at a high flow rate. After brainstorming the idea, the team designed and tested models to determine optimal design and flow rates for the system. The team also continued developing code for the entire system, and made a Computer Aided Design (CAD) [model of the UASB reactor](https://cornell47.autodesk360.com/g/shares/SH7f1edQT22b515c761e1224485004ae7e44?viewState=NoIgbgDAdAjCA0IDeAdEAXAngBwKZoC40ARXAZwEsBzAOzXjQEMyzd1C0IBOAEx4GYeAFgBsAWgBMjAGY8xQgKwTxjLl3H8A7KoBGEABwQd-IZrQBfEAF0gA) using Fusion 360.

#### Fall 2018

  During the fall of 2018, the team tested a benchtop UASB model in the lab. Because actual sludge granules were not readily available, the team used tapioca to model the sludge blanket. Tapioca has similar material properties as sludge, inexpensive and readily available made it a suitable alternate material. Tapioca was used to identify preferential paths in the UASB reactor. Preferential pathways are the uneven distribution of wastewater flow throughout the reactor; the presence of these make the UASB reactor less efficient.

  The bench top model was a scaled down version of a real UASB reactor, made using Polyvinyl Chloride (PVC). The influent was set on top perpendicular to the bottom plate and a hole was drilled at the top of the model connected with a pipe as the effluent. The team used ProCoDa software to pump the water through the influent pipe. They also added red dye to the initial pulse of water to manually to look for preferential paths.

  The result of the testing shows that the layer of tapioca did not lift entirely off the bottom of the reactor, but instead it stretched as influent “wastewater” traveled through it. The red dye in the influent revealed the formation of preferential pathways through the tapioca layer.

#### Spring 2019

  During the Spring 2019 Semester, the team focused on completing a design for the UASB reactors that will be fabricated and tested at the IAWWTP. The team decided to make reactor canisters out of 10" diameter clear PVC pipe, so that multiple reactors could be tested at the IAWWTP to determine whether or not pulsated flow affects reactor efficiency. To design the reactors, the team made a python class to represent the hydraulics of the UASB reactors and made an onShape model of the reactors.

## Summer 2019 Goals

  The main goal for the Summer 2019 is to complete the fabrication of the UASB reactors and get them up and running at the IAWWTP. The team must get develop fabrication skills and develop best practices for the assembly of the UASB reactors. Upon doing so, the team must order new materials to build its first reactor. Then, the team will install this reactor at the IAWWTP. The team will practice startup of a UASB reactor, hopefully with the assistance of sludge granules from another source. If that reactor is successful, the team will build more reactors to test different variables and install said reactors at the IAWWTP.


## Methods
Since the team will be testing various lifts in the UASB reactor ranging from 1 cm to 10 cm, the team must determine the pivot positions on the sides of the tipping bucket to get the proper pulse volume. The team has begun testing for pivot positions on a 1 gallon (or 3.8 L) bucket for 5 cm of lift and on a 2 gallon bucket (or 7.6 L) bucket for 10 cm of lift. According to the python calculations, 2.5 L of water is needed to create 5 cm of lift and 5 L of water is needed to create 10 cm of lift.

[insert picture of tipping bucket diagram, include pivots]

The previous Summer 2018 team had created a frame for the tipping bucket to rest in. However, in order to decrease cost and increase convenience during testing, the team will not use a frame to hold the tipping bucket and will use a rectangular bucket with pivots screwed directly onto the sides of the bucket where there are the holes for the tested pivot positions instead.

[insert picture of previous team's tipping bucket]

Goals for tipping bucket trial:
1. Figure out pivot points for the 1 gallon bucket to pour when the water level within the bucket reaches 2.5 L.
2. Figure out pivot points for the 2 gallon bucket to pour when the water level within the bucket reaches 5 L.
3. Adjust design and materials for additional support and stability to prevent materials from wearing down.



*Trials with asterisks indicate adjustments made during trials that are mentioned below the tables.*

**Table 1. Summer 2019 1 Gallon Tipping Bucket Trial Results**
| Trial | Horizontal Pivot Position (from center) (cm) | Vertical Position (from center) (cm)  | Volume Poured Out (L)| Emptied Completely|
| -------- | ----------------|--------------- | ---------| -------|------|
| 1    | 0.5  | 0 | 1.5 | yes |
| 2 | 0.5 | 2 | 0 | x |
|3   | 1 | 1 | 1.8 | x |
|4   | 1 | 2 | x |  x |
|5   | 1 | 1  | 2 | yes |
| 6 | 1 | 1 | 2 | yes |
|*7  | 1 | 1 | 2.3 | yes |
| 8 | 1 | 2 | x | x |
|9 | 0.75 | 1 | 2.5 | yes |
|10 | 0.75 |1 | 2.6 | yes |
| ***11** | 0.75 | 1 | 2.45 | yes |

**Trial 7:** new brackets made specifically for 1 inch pivots and continuous pouring method
**Trial 11:** final test with wall reinforcements and new pivots made out of PVC instead of HDPE

**Table 2. Summer 2019 2 Gallon Tipping Bucket Trial Results**
| Trial | Horizontal Pivot Position (from center) (cm) | Vertical Position (from center) (cm)  | Volume Poured Out (L)| Emptied Completely|
| -------- | ----------------|--------------- | ---------| -------|------|
|1| 1 | 1 | 4.6 | yes |
|2| 1 | 1 | 4.35 | yes |
|3| 1 | 1.5 | 4 |  x |
|*4| 1 |  1.5 |  4.5 | x  |
|*5| 1 | 1 | 5 | yes |
|6| 1 | 1 | 4.4 | yes |
|7| 1 | 1.5 | 4.8 | no |
|8| 1.5 | 1.5 | 2  | no  |
|9| 0.75 | 1 | 4.6 | no |
|10| 1.25 | 1.5 | 3.8 | no |
|11| 1.25 | 1.5 | 3.8 | no |
|12| 1.25 | 1.25 | 4.5 | yes |
|13| 1 | 1.25 | 4.6 | yes |
|14| 1 | 1.25 | 4.6 | yes |
|*15| 1 |1.25 | 4.7 | yes |
|16| 1.25 | 1.25 | 4.5 | yes |
|17| 1.25 | 1.25 | 4.6 | yes |
|18| 1 | 1 | 4.4 | yes |
|19| 0.75 | 1 | 4.9 | yes |
|**20**| 0.75 | 1 | 4.9 | yes |
**Trial 4:** started using new brackets made for 1 inch pivots, continuous pouring method
**Trial 5:** started using wall reinforcements made out of HDPE around the pivot points
**Trial 15:** started using new pivots made from PVC instead of HDPE

## Design Manual

So far the team has only began practicing fabrication to develop best practices for the fabrication of the UASB reactors at the IAWWTP. Below is a procedure for the fabrication of UASB reactors.

### Tipping Bucket Influent System
#### Materials:
| Item                                                           | Purpose | Dimensions                     |  Cost            | Link to Item                                                                                                                             |
| -------------------------------------------------------------- |-------| ------------------------------ | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| LLDPE Plastic Tank                        | Holding Tank                     | 18" x 12" x 18"                | $88.57                | https://www.usplastic.com/catalog/item.aspx?itemid=125824                                                                                |
| LDPE Welding Rod                         | Welding Brackets to the Holding Tank                      | 5/32" Diameter, 135ft          | $10.61                | https://www.mcmaster.com/#7889a38/=1djicjq                                                                                               |
| LDPE Plastic Sheet           |Brackets                                  | 6" x 12" x 1.5"                | $34.94                | https://www.mcmaster.com/#8657k337/=1djix0x                                                                                              |
| 1 Gallon Rectangular Bucket **or** 2 Gallon Rectangular Bucket |   Bucket    |   No dimensions specified                      | $$2.48$  **or** $4.09 | https://www.usplastic.com/catalog/item.aspx?itemid=123948&catid= **or** https://www.usplastic.com/catalog/item.aspx?itemid=123949&catid= |
| Fully Threaded PVC Plastic Hex Head Screw         | Secures Pivots and Support to Bucket             | 1/4"-20 Thread Size, 3/4" Long | $8.64                 | https://www.mcmaster.com/95841a540                                                                                                       |
| PVC Rod                                  | Pivots                      | 1" Diameter, 1' Length         | $5.83                 | https://www.mcmaster.com/87025K39                                                                                                        |
| 1/4" HDPE Sheet  | Support for sides of Bucket                                                             |                                |                       |                                                                                                                                          |

#### Tools Used:
- Power drill
  - 1/4" drill bit
- Mill
  - 7/32" drill bit
- tap wrench
  - 1/4"-20 tap
- Welding Kit
- Band Saw

#### Procedure:
1. Measure and mark where the middle of the bucket is on both sides of the bucket with the largest surface area.
2. Make a mark 0.75 cm horizontally from the center and 1 cm above the center on each side of the bucket. Make sure that the marks are aligned.
3. Use a power drill and 1/4" drill bit to drill a hole on the off-centered marks drawn in the previous step.
4. Cut two pivots from the PVC rod with a band saw to appropriate size to fit within the LLDPE plastic tank
5. Using a mill and a 7/32" drill bit, drill a hole into the middle of one of the flat sides of each pivot.
6. Use a band saw to cut two squares of 2" by 2" HDPE 1/4" sheet to reinforce the sides of the tipping bucket.
7. Drill a 1/4" hole into the middle of both squares.
8. Use a 1/4"-20 plastic screw to secure the squares of HDPE sheet to the insides of bucket and the pivots to the outsides of the bucket.
**add picture**
9. Cut a 1" x 2" rectangle from the LDPE Plastic Sheet to create brackets.
10. Weld brackets to the inside of the LDPE holding tank. Make sure the brackets are positioned so that they are at the same height in the tank and give the bucket enough space to tip over completely.


### Reactor Body

#### Materials:
| Item                                                           | Purpose | Dimensions                     |  Cost            | Link to Item                                                                                                                             |
| -------------------------------------------------------------- |-------| ------------------------------ | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| 10" Clear PVC Pipe                       | Reactor Body             | 10" diameter, 8' height               | $760.70                | https://www.mcmaster.com/49035k97                                                                               |
| 2" PVC Pipe                        |                 | 2" diameter, 5' height          | $10.80                | https://www.mcmaster.com/48925K96                                                                                               |
|Two 10" flanges          |                                 | 10" diameter              | $125.08                | https://www.pvcfittingsonline.com/854-100-10-schedule-80-pvc-molded-flange.html                                                        |
|Two Bolt Kits|   Secure Flanges to the PVC Pipe    |   Bolts: 8" x 5" Long                      | $161.60 | https://www.pvcfittingsonline.com/10bk-10-bolt-kit-for-flange-to-flange-stainless-steel.html |
| Two 10" Gaskets       | Creates water tight seal between pipe and flanges    | 10" diameter | $31.50                 | https://www.pvcfittingsonline.com/155g1258ff150-8-full-faced-epdm-gasket-6950.html                                                                                       |
| Two 10" Blind Flanges                                 |                      | 10"   diameter      | $387.12                 | https://www.pvcfittingsonline.com/10-schedule-80-pvc-blind-flange-853-100.html                                                                                   |
| Four Leveling Stands  |                                                             |                     4" Long 7/8"-9 Threaded Stud           |             $151.00          |                                                                 https://www.mcmaster.com/6111k249          |

#### Tools Used:
  - Power Drill
    - 2 3/8" hole saw
  - PVC Cement
  - Jig and Shim
  -

####Procedure:
1. Drill a 2 3/8" hole into the 10" PVC using a drill saw **add location for hole**.

2. Cut a 2" length of 2" PVC pipe.

3. Role the 10" PVC pipe onto its side and apply primer to the 2 3/8" hole and the 2" PVC pipe. Insert the 2" PVC pipe into the hole in the 10" pipe and apply PVC cement liberally to ensure that all of the gaps are filled. Use a clamp or block to support the new connection. Allow to dry completely for 24 hours. (Materials: 1 1/2" PVC pipe, 8' length of 10" PVC pipe, drill saw, primer, PVC cement)

4. Drill a 1/4" hole at a 60 degree angle in the 10" canister **add a location for hole** using a jig. Then, attach a 1' long 1/4" rod to the drill saw with a 2 3/8" drill saw bit. Use the 1/4" hole as a guide to drill a 2 3/8" hole at a 60 degree angle.

5. Cut a 2" length of 2" PVC pipe.

6. Role the 10" PVC pipe onto its side and apply primer to the 2 3/8" ellipse and the 2" PVC pipe. Insert the 2" PVC pipe into the hole in the 10" pipe and apply PVC cement liberally to ensure that all of the gaps are filled. Use a clamp or block to support the new connection. Allow to dry completely for 24 hours. (Materials: 1 1/2" PVC pipe, 8' length of 10" PVC pipe, drill saw, primer, PVC cement)

```python
import aguaclara.core.head_loss as minorloss
from aguaclara.core.units import unit_registry as u
from aguaclara.core import physchem as pc
from aguaclara.core import pipes as pipes
from aguaclara.core import head_loss as HL
from aguaclara.core import utility as ut
from aguaclara.core import constants as con
from aguaclara.research import floc_model as fm
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

pipes.OD(2*u.inch)
6/16
pipes.ID_sch40(4*u.inch)
class UASBtest:
  def __init__(
          self,
          temp = 10 * u.degC, #estimated temp at IAAWTF
          pipe_diam = 1.0 * u.inch, #diameter of the influent pipe
          n_elbows = 2, #the number of elbows in the influent pipe
          pipe_roughness = .0015 * u.mm, # PVC pipe roughness
          time_dump = 2* u.s, #NOTE: get better value with actual testing, this is a rough estimate
          UASB_diameter = 10 * u.inch,
          UASB_height = 8 * u.ft, #this height refers to the height of the pipe that is used to make the UASB canister, NOT the water level in the UASB.
          HRT = 4 * u.hr, #minimum HRT of wastewater in reactor for adequate treatment NOTE: some studies have shown 6 hrs is optimal
          target_upflow_vel= 10 * u.m/u.hr, #target up flow velocity to fluidize sludge blanket
          diameter_drain_pipe = 4 * u.inch, #diameter of the pipe that connects the holding tank to influent pipe ( 3 inches was chosen so that the area was similar to that of one section in drain tank in previous design.)
          descending_sewage_vel= .2 * u.m/u.s, #Maximum velocity that will allow air bubbles to rise out of reactor. Must only be achieved in beginning of influent pipe systems, not throughout.
          ww_gen_rate = 10.8 * u.L/u.hr, #Wastewater Generation per Person
          angle_sludge_weir=60*u.degrees, #angle of sludge weir
          percent_sludge= .7, #based on summer 2018 team research
          diam_sludge_granules = .5 * u.mm, #this is the lower end of range of diameters for sludge, goes up to 3 mm https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6070658/ so this would correspond to a slower setting particle
          rho_sludge= 1383 * u.g/u.L, #density of sludge granules. source:https://www.ijsr.net/archive/v4i4/SUB153022.pdf
          rho_water=1 *u.g/u.mL,
          lift= 10*u.cm, #to make sure that lift height is significant
          effluent_pipe_diameter=1*u.inch,
          tippingbucket_diameter=6.25 * u.inch

):
      """Instantiate a UASB object, representing a real UASB component.
      :param Q: Flow rate of water water through the UASB.
      :type Q: float * u.L/u.s
      :param temp: Water temperature of the UASB
      :type temp: float * u.degC
      :param cannister_diam: diameter of the UASB canister
      :type cannister_diam: float * u.ft
      :param effluent_H: height of effluent line in UASB
      :type effluent_H: float * u.ft
      :param vol_dump: volume of one complete dump from tipping bucket
      :type vol_dump: float * u.L
      :param pipe_diam: ID of the influent pipes
      :type pipe_diam: float * u.inch
      :param n_elbows: number of 90 degree elbows per influent pipe
      :type n_elbows: float * dimensionless
      :param pipe_roughness: roughness of influent pipes
      :type pipe_roughness: float * u.m
      :returns: object
      :rtype: UASB
      """
      self.temp = temp
      self.pipe_diam = pipes.ID_sch40(pipe_diam)
      self.n_elbows = n_elbows
      self.pipe_roughness = pipe_roughness
      self.time_dump = time_dump
      self.UASB_diameter = pipes.ID_sch40(UASB_diameter)
      self.HRT = HRT
      self.target_upflow_vel=target_upflow_vel
      self.diameter_drain_pipe=pipes.ID_sch40(diameter_drain_pipe)
      self.descending_sewage_vel=descending_sewage_vel
      self.percent_sluge=percent_sludge
      self.UASB_height=UASB_height
      self.effluent_pipe_diameter=pipes.ID_sch40(effluent_pipe_diameter)
      self.ww_gen_rate=ww_gen_rate
      self.lift=lift
      self.tippingbucket_diameter=tippingbucket_diameter

  @property
  def UASB_area(self):
    """This function calculates the surface area of the UASB canister """
    area= pc.area_circle(self.UASB_diameter)
    return area

  @property
  def vol_dump(self):
    vol=self.lift*self.UASB_area
    return vol

  @property
  def area_drain_pipe(self):
    area=pc.area_circle(self.diameter_drain_pipe)
    return area

  @property
  def HG_per_dump(self):
    """This function calculates the head gain per dump, assuming that the water level in the canister is in line with the bottom of the "drain pipe" that connects the holding tank to the 1 inch influent pipe """
    HG=self.vol_dump/self.area_drain_pipe
    return HG

  @property
  def length_drain_pipe(self):
    """This function calculates the length of the drain pipe necessary so that the volume of 1 dump from the tipping bucket fills the drain pipe"""
    h=(self.HG_per_dump).to(u.inch)
    return h  

  @property
  def water_level_height(self):
    """This function determines the height of the water level in the reactor. The water level is supposed to be in line with the bottom of the drain pipe"""
    #NOTE: how much "safety" do we want here? also, are
    return self.UASB_height

  @property
  def volume_UASB(self):
    """this function calculates volume of liquid inside UASB reactor, not including influent pipes"""
    vol=self.UASB_area*self.water_level_height
    return vol

  @property
  def flow_rate_avg(self):
    """this function estimates the max flow rate, given min HRT and volume of fluid inside canister, that the UASB can handle"""
    Qmax=(self.volume_UASB)/self.HRT
    return Qmax

  @property
  def upflow_vel_avg(self):
    """this function calculates the average up flow velocity of in the UASB canister"""
    up_v=self.flow_rate_avg/self.UASB_area
    return up_v

  @property
  def aggregate_k(self):
    """This function calculates  the aggregate minor loss coefficient of the drain system from the holding tank into the 'canister' aka the 10 inch clear PVC pipe"""
    influent_K=self.n_elbows*minorloss.EL90_K_MINOR+minorloss.PIPE_EXIT_K_MINOR+minorloss.PIPE_ENTRANCE_K_MINOR
    return influent_K

  @property
  def drain_time(self):
    """This function calculates how long it takes for a dump from the tipping bucket to drain into the tank, assuming that the bottom of the drain pipe (which connects the 1.5 inch pipe to the holding tank) is in line with the water level in the canister and does not begin draining out until the dump is complete. Note that this time should be approximately the same as the time it takes for the tipping bucket to fill up/fast enough to produce desired up flow velocity in the tank"""
    #NOTE: should we include minor loss from holding tank to drain tank, or assume water just starts from drain tank
    #NOTE: drain time also might drastically underestimate actual drain time, since all the water from the tipping bucket won't necessarily go straight into the drain pipe from the tipping bucket, but could linger around the bottom of the holding tank.  
    time = 8*self.area_drain_pipe/(np.pi*(self.pipe_diam)**2)*(self.HG_per_dump*self.aggregate_k/(2*pc.gravity))**(1/2)
    return time    


  @property
  def upflow_velocity_pulse_average(self):
    """this function estimates the average upflow velocity in the canister during a pulse by dividing the time it takes for a dump from the tipping bucket to drain into the system to get a "pulse flow rate" and then dividing that by the cross sectional area of the UASB to get an estimate for "pulse up flow velocity"""
    UASB_Q_dump=self.vol_dump/self.drain_time ##calculate flow rate through UASB as water from a dump of tipping bucket flows through the system
    up_vel=UASB_Q_dump/self.UASB_area
    return up_vel.to(u.m/u.s)

  @property
  def bucket_fill_time(self):
    """This function determines the estimated time it will take the tipping bucket to fill, using the estimated volume of one dump from the new, smaller tipping bucket size and the flow rate of water entering the UASB, according to the function flow_rate_max"""
    UASB_Q_dump=self.vol_dump/self.drain_time #calculate flow rate through UASB as water from a dump of tipping bucket flows through the system
    up_vel=UASB_Q_dump/self.UASB_area
    return up_vel.to(u.m/u.s)

  @property
  def num_people_served(self):
    """This function estimates the number of people that could be served by a UASB reactor of this size"""
    num=self.flow_rate_avg/self.ww_gen_rate
    num=num.to(u.dimensionless)
    return num

  @property
  def pivot_height(self):
    """This function estimates the height of the pivots on the tipping bucket, so that the bucket will dump at desired volume"""
    return (self.vol_dump/pc.area_circle(self.tippingbucket_diameter)).to(u.inch)


test=UASBtest(pipe_diam=1.5*u.inch, lift=5*u.cm)
data ={'UASB element':['Diameter Canister', 'Diameter Influent Pipe', 'Number of Elbows in Influent', 'Average Up flow Pulse Velocity', 'Tipping Bucket Dump Volume', 'Length Pulse Pipe', 'Diameter Pulse Pipe', 'Water Level Height', 'Lift', 'Pivot Height' ],
       'Measurement': [test.UASB_diameter, test.pipe_diam, test.n_elbows, (test.upflow_velocity_pulse_average).to(u.mm/u.s), test.vol_dump.to(u.gal), test.length_drain_pipe, test.diameter_drain_pipe, test.water_level_height, test.lift, test.pivot_height]}

print((test.upflow_vel_avg).to(u.mm/u.s))
df=pd.DataFrame(data)
print(df)

  @property
  def biogas_produced_rate(self):
    """This function estimates the amount of biogas that will be produced by the reactor """
    COD=self.influent_BOD/.6
    COD_rem = COD * .7 #Assuming .5% efficency of COD removal and conversion in reactor
    BGMax = (COD_rem * 0.378 * self.flow_rate_avg * (u.ml/u.mg)).to(u.L/u.day) #Theoretical Production, from Fall 2014 UASB team report
    BGMin = (COD_rem * 0.06 * self.flow_rate_avg * (u.ml/u.mg)).to(u.L/u.day)  #Production using minimum value from Van Lier report
    BGAvg = (COD_rem * 0.16 * self.flow_rate_avg * (u.ml/u.mg)).to(u.L/u.day)#Production using average value from Spring 2014 tests
    return [BGMax, BGAvg, BGMin]

  @property
  def biogas_produced_rate_2(self):  
    return (self.flow_rate_avg/10).to(u.L/u.day)

  @property
  def Energy_Production(self):    
    return (self.biogas_produced_rate_2 / (700 * (u.L/(u.kW*u.hr))))  #Hours of stove usage, given minimum efficency
    #KWH = Biogas / (700 * u.L/u.kwh) #Kilowatt Hours generated from biogas used


test=UASBtest(pipe_diam=1.5*u.inch, lift=5*u.cm)
data ={'UASB element':['Diameter Canister', 'Diameter Influent Pipe', 'Number of Elbows in Influent', 'Average Up flow Pulse Velocity', 'Tipping Bucket Dump Volume', 'Length Pulse Pipe', 'Diameter Pulse Pipe', 'Water Level Height', 'Lift', 'Pivot Height' ],
       'Measurement': [test.UASB_diameter, test.pipe_diam, test.n_elbows, (test.upflow_velocity_pulse_average).to(u.mm/u.s), test.vol_dump.to(u.gal), test.length_pulse_pipe, test.diameter_pulse_pipe, test.water_level_height, test.lift, test.pivot_height]}

print((test.vol_dump).to(u.L))
#df=pd.DataFrame(data)
#print(df)
print(test.biogas_produced_rate)

print((test.Energy_Production).to(u.kJ/u.day))

print(test.num_people_served)
<<<<<<< HEAD
```
```Python
from selenium import webdriver
from BeautifulSoup import BeautifulSoup
import pandas as pd

driver = webdriver.Chrome("/usr/lib/chromium-browser/chromedriver")

comment=[] #List to store name of the product
driver.get("https://twitter.com/search?q=elizabeth%20warren&src=typd")


content = driver.page_source
soup = BeautifulSoup(content)
for a in soup.findAll('a',href=True, attrs={'class':'js-tweet-text-containter'}):
  comment=a.find('div', attrs={'class':'_3wU53n'})

comment.append(comment.text)
```
=======

>>>>>>> bde1f4e98ac1c9c6341e9bc6483ea73647feba55

## 2019 TechConnect

UASB (along with fellow AguaClara subteam Ram Pump) was invited to the 2019 TechConnect World Innovation Conference & Expo as the result of winning the EPA P3 Phase II grant this spring. Members of the team presented the work done to develop gravity-powered wastewater treatment through the use of UASB reactors, as well as general information on AguaClara. View the poster presentation from the conference [here](https://github.com/AguaClara/UASB/blob/master/Posters%20and%20Presentations/2019%20TechConnect%20Conference%20Poster.pdf).

## Future Work



# EPA Funding Assurance
This publication [article] was developed under Assistance Agreement No. SU-83926801 awarded by the U.S. Environmental Protection Agency to Cornell University. It has not been formally reviewed by EPA. The views expressed in this document are solely those of [name of recipient or names of authors] and do not necessarily reflect those of the Agency. EPA does not endorse any products or commercial services mentioned in this publication.

# Pictures

**Figure 1. Testing if Rubber Cement Seals Pipes Water Tight.**

<img src="https://github.com/AguaClara/UASB/blob/master/Images/FabPracLeak.jpeg?raw=true">

**Figure 2. Fabrication Practice.**

<img src="https://github.com/AguaClara/UASB/blob/master/Images/Fabrication%20Practice.jpg?raw=true">

**Figure 3. Tipping Bucket with Pivots.**

<img src="https://github.com/AguaClara/UASB/blob/master/Images/Tipping%20Bucket%20with%20Pivots.jpg?raw=true">

**Figure 4. Top View of Tipping Bucket .**

<img src="https://github.com/AguaClara/UASB/blob/master/Images/Top%20View%20of%20Tipping%20Bucket%20with%20Pivots.jpg?raw=true">

**Figure 5. Top View of Holding Tank with Brackets.**

<img src="https://github.com/AguaClara/UASB/blob/master/Images/Top%20View%20of%20Holding%20Tank%20with%20Bracket%20.jpg?raw=true">


**Figure 6. Testing Tipping Bucket with Continuous Flow.**

<img src="https://github.com/AguaClara/UASB/blob/master/Images/Testing%20Tipping%20Bucket%20with%20Continuous%20Flow.jpg?raw=true">

**Figure 7. Influent System.**

<img src="https://github.com/AguaClara/UASB/blob/master/Images/Influent%20System.jpg?raw=true">
